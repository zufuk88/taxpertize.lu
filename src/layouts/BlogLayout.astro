---
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';

export interface Props {
  title: string;
  description?: string;
  author?: string;
  date?: string;
  category?: string;
  readTime?: string;
  image?: string;
}

const {
  title,
  description = "Taxpertize Blog - Tax insights and updates from Luxembourg",
  author,
  date,
  category,
  readTime,
  image
} = Astro.props;

const formattedDate = date ? new Date(date).toLocaleDateString('en-GB', {
  year: 'numeric',
  month: 'long',
  day: 'numeric'
}) : '';
---

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="description" content={description} />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />

    <!-- Preconnect to Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    <!-- Google Font: Playfair Display (Times New Roman equivalent) -->
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">

    <!-- Global Styles -->
    <link rel="stylesheet" href="/src/styles/global.css" />

    <meta name="generator" content={Astro.generator} />
    <title>{title} | Taxpertize Blog</title>

    <!-- Open Graph -->
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    {image && <meta property="og:image" content={image} />}
    <meta property="og:type" content="article" />

    <!-- Breadcrumbs Schema -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": "Home",
          "item": "https://taxpertize.lu"
        },
        {
          "@type": "ListItem",
          "position": 2,
          "name": "Blog",
          "item": "https://taxpertize.lu/blog"
        },
        {
          "@type": "ListItem",
          "position": 3,
          "name": ${JSON.stringify(title)}
        }
      ]
    }
    </script>

    <!-- Article Schema -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Article",
      "headline": ${JSON.stringify(title)},
      "description": ${JSON.stringify(description)},
      "author": {
        "@type": "Person",
        "name": ${JSON.stringify(author || "Taxpertize Team")}
      },
      "datePublished": ${JSON.stringify(date)},
      "publisher": {
        "@type": "Organization",
        "name": "Taxpertize",
        "logo": {
          "@type": "ImageObject",
          "url": "https://taxpertize.lu/logo.png"
        }
      },
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": ${JSON.stringify(`https://taxpertize.lu${Astro.url.pathname}`)}
      }
    }
    </script>
  </head>
  <body>
    <Header />

    <article class="blog-article">
      <div class="article-container">
        <!-- Breadcrumbs -->
        <nav class="breadcrumbs" aria-label="Breadcrumb">
          <a href="/" class="breadcrumb-link">Home</a>
          <span class="breadcrumb-separator">/</span>
          <a href="/blog" class="breadcrumb-link">Blog</a>
          <span class="breadcrumb-separator">/</span>
          <span class="breadcrumb-current">{title}</span>
        </nav>

        {(author || date || category || readTime) && (
          <header class="article-header">
            <div class="article-meta">
              {category && (
                <a href={`/blog/category/${category.toLowerCase().replace(/\s+/g, '-')}`} class="article-category">
                  {category}
                </a>
              )}
              {date && <span class="article-date">{formattedDate}</span>}
              {readTime && <span class="article-read-time">{readTime} read</span>}
            </div>
            <h1 class="article-title">{title}</h1>
            {description && <p class="article-description">{description}</p>}
            {author && (
              <div class="article-author">
                <span>By {author}</span>
              </div>
            )}
          </header>
        )}

        <div class="article-content">
          <slot />
        </div>
      </div>
    </article>

    <Footer />
  </body>
</html>

<style>
  .blog-article {
    padding: var(--space-2xl) 0 var(--space-4xl) 0;
    min-height: 70vh;
    width: 100%;
  }

  .article-container {
    width: 100%;
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 var(--space-xl);
    box-sizing: border-box;
  }

  .breadcrumbs {
    display: flex;
    align-items: center;
    gap: var(--space-xs);
    margin-bottom: var(--space-xl);
    font-size: var(--font-size-sm);
    color: var(--color-text-light);
  }

  .breadcrumb-link {
    color: var(--color-text-light);
    text-decoration: none;
    transition: color 0.3s ease;
  }

  .breadcrumb-link:hover {
    color: var(--color-primary);
    text-decoration: underline;
  }

  .breadcrumb-separator {
    opacity: 0.5;
  }

  .breadcrumb-current {
    color: var(--color-primary);
    font-weight: 500;
    max-width: 300px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .article-header {
    max-width: 850px;
    margin: var(--space-lg) auto var(--space-2xl) auto;
    text-align: center;
    position: relative;
    padding: var(--space-xl) var(--space-lg);
    background: linear-gradient(135deg, rgba(255, 165, 0, 0.02), transparent);
    border-radius: var(--radius-lg);
    box-sizing: border-box;
  }

  .article-header > * {
    position: relative;
    z-index: 1;
  }


  .article-meta {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: var(--space-md);
    margin-bottom: var(--space-lg);
    flex-wrap: wrap;
  }

  .article-category {
    display: inline-block;
    padding: 4px 12px;
    background: linear-gradient(135deg, rgba(255, 165, 0, 0.1), rgba(255, 140, 0, 0.05));
    border: 1px solid rgba(255, 165, 0, 0.2);
    color: var(--color-primary);
    font-size: var(--font-size-sm);
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    border-radius: var(--radius-sm);
    text-decoration: none;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
  }

  .article-category::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 165, 0, 0.2), transparent);
    transition: left 0.5s ease;
  }

  .article-category:hover::before {
    left: 100%;
  }

  .article-category:hover {
    background: linear-gradient(135deg, rgba(255, 165, 0, 0.15), rgba(255, 140, 0, 0.1));
    border-color: rgba(255, 165, 0, 0.3);
    transform: translateY(-2px);
  }

  .article-date,
  .article-read-time {
    font-size: var(--font-size-sm);
    color: var(--color-text-light);
  }

  .article-title {
    font-size: clamp(2rem, 4vw, 3rem);
    font-weight: 900;
    color: var(--color-primary);
    margin-bottom: var(--space-lg);
    line-height: 1.3;
    position: relative;
    display: block;
  }

  .article-description {
    font-size: var(--font-size-xl);
    color: var(--color-text-light);
    line-height: 1.6;
    margin-bottom: var(--space-lg);
  }

  .article-author {
    font-size: var(--font-size-base);
    color: var(--color-text);
    font-weight: 500;
  }

  .article-content {
    max-width: 720px;
    margin: var(--space-xl) auto 0 auto;
    padding: 0 var(--space-md);
    box-sizing: border-box;
  }

  .article-content :global(h2) {
    font-size: var(--font-size-2xl);
    font-weight: 700;
    color: var(--color-primary);
    margin: var(--space-2xl) 0 var(--space-lg) 0;
    line-height: 1.3;
  }

  .article-content :global(h3) {
    font-size: var(--font-size-xl);
    font-weight: 600;
    color: var(--color-primary);
    margin: var(--space-xl) 0 var(--space-md) 0;
    line-height: 1.4;
  }

  .article-content :global(p) {
    font-size: var(--font-size-base);
    line-height: 1.75;
    margin-bottom: var(--space-lg);
    color: var(--color-text);
  }

  .article-content :global(ul),
  .article-content :global(ol) {
    margin: var(--space-md) 0 var(--space-lg) 0;
    padding-left: var(--space-xl);
  }

  .article-content :global(li) {
    margin-bottom: var(--space-sm);
    line-height: 1.75;
    color: var(--color-text);
  }

  .article-content :global(strong) {
    font-weight: 600;
    color: var(--color-primary);
  }

  .article-content :global(blockquote) {
    border-left: 4px solid var(--color-primary);
    padding-left: var(--space-lg);
    margin: var(--space-lg) 0;
    font-style: italic;
    color: var(--color-text-light);
  }

  .article-content :global(code) {
    background: var(--color-accent-light);
    padding: 2px 6px;
    border-radius: var(--radius-sm);
    font-size: 0.9em;
  }

  .article-content :global(pre) {
    background: var(--color-accent-light);
    padding: var(--space-md);
    border-radius: var(--radius-md);
    overflow-x: auto;
    margin-bottom: var(--space-md);
  }

  /* Mobile Responsive */
  @media (max-width: 640px) {
    .article-container {
      padding: 0 var(--space-md);
    }

    .breadcrumbs {
      font-size: var(--font-size-xs);
    }

    .article-header {
      margin-bottom: var(--space-2xl);
      padding: var(--space-lg) var(--space-md);
    }

    .article-title {
      font-size: clamp(1.5rem, 5vw, 2rem);
    }

    .article-description {
      font-size: var(--font-size-base);
    }

    .article-content {
      padding: 0;
    }

    .article-content :global(h2) {
      font-size: var(--font-size-xl);
    }

    .article-content :global(h3) {
      font-size: var(--font-size-lg);
    }

    .article-content :global(p) {
      font-size: var(--font-size-sm);
      line-height: 1.7;
    }
  }
</style>